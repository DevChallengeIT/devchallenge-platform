<div class="bg-white border my-3 shadow-sm rounded-md p-4 md:p-5 dark:bg-gray-800 dark:border-gray-700 dark:shadow-slate-700/[.7] mb-3">
  <div class="flex justify-between">
    <h1 class="<%= UI::H1 %> mb-5">
      <%= challenge.title %>
      <% if Auth.admin?(current_user) %>
        <%= link_to t('words.edit'), edit_admin_challenge_path(challenge), class: UI::LINK %>
      <% end %>
    </h1>

    <% if current_user && Competition.can_join?(user: current_user, challenge: challenge) %>
      <%= button_to t('words.join'), challenge_members_path(challenge), method: :post, class: UI::BUTTON_PRIMARY %>
    <% elsif current_member && Competition.can_leave?(user: current_user, challenge: challenge) %>
      <%= button_to t('words.leave'), challenge_member_path(challenge, current_member), method: :delete, class: UI::BUTTON_DANGER, form: { data: {turbo_confirm: t('messages.are_you_sure')}} %>
    <% else %>
      <%= render(UI::ChallengeRegistrationInfoComponent.new(user: current_user, challenge:)) %>
    <% end %>
    
  </div>

  <div class="my-3 text-gray-800 dark:text-gray-400">
    <%= challenge.description %>
  </div>
  
  <div class="flex space-x-5 justify-between">
    <div>
      <h4 class="<%= UI::H3 %>">Registration</h4>
      <%= render(UI::TimestampComponent.new(data: challenge.registration_at)) %>
    </div>
    <div>
      <h4 class="<%= UI::H3 %>">Start</h4>
      <%= render(UI::TimestampComponent.new(data: challenge.start_at)) %>
    </div>
    <div>
      <h4 class="<%= UI::H3 %>">Finish</h4>
      <%= render(UI::TimestampComponent.new(data: challenge.finish_at)) %>
    </div>
  </div>

  <% if true %>
    <div class="my-5">
      <% @tasks.each do |task| %>
        <% if user_authorized_for_task?(task) %>
          <%= link_to task.title, task_path(task) %>
        <% else %>
          <%= task.title %> -> <%= task.start_at %> - <%= task.submit_at %>
        <% end %>
      <% end %>
    </div>
  <% end %>

  <div class="flex items-center justify-between my-5">
    <%= link_to t('words.back'), root_path, class: UI::BUTTON_SECONDARY %>
  </div>
</div>
